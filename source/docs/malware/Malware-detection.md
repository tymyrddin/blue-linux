# Malware detection

Overcome any embarrassment. Getting cooties can happen to the best. Plus embarrassment doesn't work, it lacks the head, hands and keyboard.

## Check for new accounts

Check `/etc/passwd` for new accounts. Especially new accounts you don't recognise with a `UID` less than `500` are very suspicious. If a new account with a `UID` of `0` is in the list, definitely check it out. Also look for orphaned files, indicators of an account that has been deleted (may take a while):

    $ sudo find / -nouser -print

## Take a look at processes

Take a look at your processes with `ps -aux`, `htop` or `pstree` for unusual processes.

If you are new to linux and your installation process took care of running most of the programs it can be hard to know what’s really supposed to be running vs. what’s not supposed to be there. Plus some of the best rootkits hide from such checks. If you installed an [intrusion detection systems (IDS)](../ids/README.md), you may find some clues in its reports.

## Use rootkit scanners for additional information

Boot the machine from a known safe live-CD image and scan for suspicious files with a [rootkit scanner](../scanners/README.md).

## Check crontab

Check crontab, it may be that the keylogger is relaunched regularly when it is shut off or if the system reboots.

## Check email streams

Look at the email streams. When programs start sending email by using another IP than your email server (if you have one), it might be something fishy. It can of course also be legitimate. Also consider that a keylogger might just log in to your email server with valid credentials and email from there.

## Trick

A trick to try if a keylogger is present:

* Type a random unique string on your keyboard in the live running machine.
* Reboot the machine from a known LiveCD or LiveUsb and grep for that string.
* Find out where the string is stored, and you may have the temp file of the keylogger.
* Check the folder it is in, and check the folders upward in the tree.

